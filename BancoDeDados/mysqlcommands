CREATE TABLE Users
(
	UserID int PRIMARY KEY AUTO_INCREMENT,
    Nome varchar(100) NOT NULL,
    Email varchar(100) UNIQUE NOT NULL,
    Pass varchar(25) NOT NULL,
    City varchar(25),
    ImagePath varchar(1024),
    Visibility int DEFAULT 0,
    RegisterDate datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
    LastLogin datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
    LastModification datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
    INDEX(Email, Pass)         
);

 CREATE TABLE Relacionamento(
	UserID1 int NOT NULL,
	UserID2 int NOT NULL,
	FOREIGN KEY (UserID1) REFERENCES Users(UserID),
	FOREIGN KEY (UserID2) REFERENCES Users(UserID),
	Status int NOT NULL,
	INDEX(UserID1)
);

CREATE TABLE Grupo(
	GrupoID int PRIMARY KEY AUTO_INCREMENT,
	Nome varchar(50) NOT NULL,
	Visibilidade int DEFAULT 0,
	Descrição varchar(1000),
	Foto varchar(1024)
);

CREATE TABLE GrupoAdmin(
	GrupoID int NOT NULL,
	UserID int NOT NULL,
	FOREIGN KEY (GrupoID) REFERENCES Grupo(GrupoID) ON DELETE CASCADE,
	FOREIGN KEY (UserID) REFERENCES Users(UserID)
);

CREATE TABLE RelacionamentoGU(
	GrupoID int NOT NULL,
	UserID int NOT NULL,
	Status int NOT NULL DEFAULT 1,
	PRIMARY KEY (GrupoID, UserID),
	FOREIGN KEY (GrupoID) REFERENCES Grupo(GrupoID) ON DELETE CASCADE,
	FOREIGN KEY (UserID) REFERENCES Users(UserID)
);
PEGAR OS GRUPOS DISPONIVEIS + SITUACAO DO USUARIO COM ESTE GRUPOS
VAI NA TABELA DE GRUPO, PEGA O ID DO CRIADOR, CHECA SE ESTÁ BLOQUEADO E DEFINE O STATUS, PEGA O ID DO GRUPO VAI NA RELACAO E DEFINE A SITUACAO NO GRUPO

SELECT g.Nome, g.Descricao, g.Foto, MAX(r.Status) as RelationADMIN FROM Grupo as g, RelationGU as rg LEFT JOIN Relacionamento as r ON ( r.UserID1 = 3 AND r.UserID2 = rg.UserID ) WHERE rg.Staff = 1 AND g.GrupoID = rg.GrupoID GROUP BY g.GrupoID;

PEGAR O STATUS DO USUARIO COM O GRUPO AGORA :

SELECT g.GrupoID, g.Nome, g.Descricao, g.Foto, rg.Status as UserStatus, MAX(r.Status) as RelationADMIN FROM Grupo as g LEFT JOIN RelationGU as rg ON (rg.UserID = 3 && rg.GrupoID = g.GrupoID) LEFT JOIN Relacionamento as r ON (r.UserID1 = 3 AND r.UserID2 = rg.UserID AND rg.Staff = 1) GROUP BY g.GrupoID;


CREATE TABLE Publicacao(
	PublicacaoID int PRIMARY KEY AUTO_INCREMENT,
	UserID int NOT NULL,
	Imagem varchar(1024),
	Texto varchar(500),
	FOREIGN KEY (UserID) REFERENCES Users(UserID)	
);

CREATE TABLE Comentario(
	ComentarioID int PRIMARY KEY AUTO_INCREMENT,
	UserID int NOT NULL,
	PublicacaoID int NOT NULL,
	Texto varchar(500) NOT NULL,	
	FOREIGN KEY (PublicacaoID) REFERENCES Publicacao(PublicacaoID) ON DELETE CASCADE,
	FOREIGN KEY (UserID) REFERENCES Users(UserID)
);

CREATE TABLE Respostas
(
	RespostaID int PRIMARY KEY AUTO_INCREMENT,
	UserID int NOT NULL,
	ComentarioID int NOT NULL,
	Texto varchar(500) NOT NULL,
	FOREIGN KEY (UserID) REFERENCES Users(UserID),
	FOREIGN KEY (ComentarioID) REFERENCES Comentario(ComentarioID) ON DELETE CASCADE
	
);

CREATE TABLE MuralGrupo
(
	GrupoID int NOT NULL,
	PublicacaoID int NOT NULL,
	FOREIGN KEY (GrupoID) REFERENCES Grupo(GrupoID) ON DELETE CASCADE,
	FOREIGN KEY (PublicacaoID) REFERENCES Publicacao(PublicacaoID) ON DELETE CASCADE,
);

CREATE TABLE MuralUsers
(
	UserID int NOT NULL,
	PublicacaoID int NOT NULL,
	FOREIGN KEY (PublicacaoID) REFERENCES Publicacao(PublicacaoID) DATELE ON CASCADE,
	FOREIGN KEY (UserID) REFERENCES Users(UserID),
	
);
